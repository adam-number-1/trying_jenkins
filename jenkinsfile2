pipeline{
	agent {
    docker {
        image 'python:3.10-jdk-alpine'
        label 'built-in'
        args  '-v /tmp:/tmp'
    }
    }

	stages{
		stage("GitHub Checkout and setup"){
		    steps{
    			echo 'Cloning repository'
                sh 'pwd'
    			sh 'ls -la'
                sh 'chmod +x setup_script2'
            script{
                def out = sh script: './setup_script2', returnStdout: true
                echo '${out}'
            }
		    }
		}
		stage("Test"){
		    steps{
    			echo 'Starting Pytest'
   			    sh 'python3 -m pytest --junitxml=./junitreport/output.xml'
		    }
		}
	}
	post{
		always{
			echo 'publishing JUnit test report'
			junit skipMarkingBuildUnstable: true, testResults: 'junitreport/output.xml'
		}
	}
	
	
	
}